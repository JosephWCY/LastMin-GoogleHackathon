{"files":[{"id":"59e90d65-4214-4ddd-abfe-20207c8d8975","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Singapore\",\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"dependencies\": {\n    \"enabledAdvancedServices\": [\n      {\n        \"userSymbol\": \"Sheets\",\n        \"serviceId\": \"sheets\",\n        \"version\": \"v4\"\n      },\n      {\n        \"userSymbol\": \"Drive\",\n        \"version\": \"v3\",\n        \"serviceId\": \"drive\"\n      }\n    ],\n    \"libraries\": [\n      {\n        \"userSymbol\": \"LeadData\",\n        \"version\": \"0\",\n        \"libraryId\": \"1GUSSXFSVxoYhrSyNsRl2XZPJ3hRF7EQKhMAXuJDybBZrS7i0w48-4Y4Y\",\n        \"developmentMode\": true\n      }\n    ]\n  },\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE\"\n  }\n}"},{"id":"114abdf8-71c8-4a37-ac38-213d6de187fa","name":"Lead","type":"server_js","source":"function checkOrCreateSheet() {\n  var folderId \u003d \u00271BIvaar9xggXcqM1R_PPJSqWeF_2HLK6B\u0027; \n  var fileName \u003d \u0027LeadExample\u0027; \n  var sheetNames \u003d [\u0027CampaignData\u0027, \u0027LeadData\u0027, \u0027TaskData\u0027, \u0027ContentData\u0027]; // Array of sheet names\n\n    // Get the folder by ID\n  var folder \u003d DriveApp.getFolderById(folderId);\n  var files \u003d folder.getFilesByName(fileName);\n\n  if (files.hasNext()) {\n    var file \u003d files.next();\n    var spreadsheet \u003d SpreadsheetApp.open(file);\n    \n    // Check and create sheets if they don\u0027t exist\n    sheetNames.forEach(function(sheetName) {\n      var sheet \u003d spreadsheet.getSheetByName(sheetName);\n      if (sheet) {\n        Logger.log(\u0027The sheet \"\u0027 + sheetName + \u0027\" already exists in the Google Sheet file \"\u0027 + fileName + \u0027\".\u0027);\n      } else {\n        Logger.log(\u0027The sheet \"\u0027 + sheetName + \u0027\" does not exist. Creating new sheet in the Google Sheet file \"\u0027 + fileName + \u0027\".\u0027);\n        var newSheet \u003d spreadsheet.insertSheet(sheetName);\n        addExampleData(newSheet, sheetName);\n      }\n    });\n\n  } else {\n    Logger.log(\u0027The Google Sheet file \"\u0027 + fileName + \u0027\" does not exist. Creating new file and sheets.\u0027);\n\n    // Create a new Google Sheet file\n    var newSpreadsheet \u003d SpreadsheetApp.create(fileName);\n    var newFile \u003d DriveApp.getFileById(newSpreadsheet.getId());\n\n\n    var sheet \u003d newSpreadsheet.getActiveSheet();\n\n    // Move the new sheet file to the desired folder\n    folder.addFile(newFile);\n    DriveApp.getRootFolder().removeFile(newFile);\n  }\n}\n\n// Adds example data based on the sheet name\nfunction addExampleData(sheet, sheetName) {\n  switch (sheetName) {\n    case \u0027CampaignData\u0027:\n      addCampaignExampleData(sheet);\n      break;\n    case \u0027LeadData\u0027:\n      addLeadExampleData(sheet);\n      break;\n    case \u0027TaskData\u0027:\n      addTaskExampleData(sheet);\n      break;\n    case \u0027ContentData\u0027:\n      addContentExampleData(sheet);\n      break;\n    default:\n      Logger.log(\u0027No example data available for sheet: \u0027 + sheetName);\n  }\n}\n\nfunction addCampaignExampleData(sheet) {\n  sheet.appendRow([\u0027CID\u0027, \u0027Name\u0027, \u0027Description\u0027, \u0027Lead Name\u0027, \u0027Progress\u0027, \u0027Target Start Dates\u0027,\t\u0027Target End Date\u0027,\t\u0027Actual Start Date\u0027,\t\u0027Actual End Date\u0027,\t\u0027Status\u0027]);\n  sheet.appendRow([\u0027C-1\u0027,\t\u0027TestSample2\u0027,\t\u0027HelloDescription\u0027,\t\u0027John Doe\u0027,\t\u002720%\u0027,\t\u002707/10/2022\u0027,\t\u00271/9/23\u0027,\t\u002713/04/2023\u0027,\t\u00278/6/23\u0027,\t\u0027Scheduled\u0027]);\n  sheet.appendRow([\u0027C-2\u0027,\t\u0027Sample2\u0027,\t\u0027Desp2\u0027,\t\u0027Jane Smith\u0027,\t\u002730%\u0027,\t\u002705/07/2024\u0027,\t\u002709/07/2024\u0027,\t\u002705/07/2024\u0027,\t\u002730/07/2024\u0027,\t\u0027Planned\u0027]);\n  sheet.appendRow([\u0027C-3\u0027,\t\u0027Sample3\u0027,\t\u0027Desp3\u0027,\t\u0027Mark Brown\u0027,\t\u002750%\u0027,\t\u00278/31/23\u0027,\t\u002712/30/23\u0027,\t\u00272/24/24\u0027,\t\u00276/10/24\u0027,\t\u0027Active\u0027]);\n}\n\nfunction addLeadExampleData(sheet) {\n  sheet.appendRow([\u0027Lead Name\u0027, \u0027Email\u0027, \u0027Phone\u0027, \u0027Company\u0027, \u0027Job Title\u0027, \u0027Status\u0027,\t\u0027Assigned To\u0027,\t\u0027Date Added\u0027,\t\u0027Last Contacted\u0027,\t\u0027Notes\u0027,\t\u0027Lead Score\u0027]);\n  sheet.appendRow([\u0027John Doe\u0027, \u0027john@example.com\u0027, \u0027123-456-7890\u0027,\t\u0027Example Corp\u0027,\t\u0027Marketing Manager\u0027,\t\u0027New\u0027,\t\u0027Marketing Team\u0027,\t\u00272024-07-01\u0027,\t\u00272024-07-15\u0027,\t\u0027Interested in product demo\u0027,\t85]);\n  sheet.appendRow([\u0027Jane Smith\u0027,\t\u0027jane@example.com\u0027,\t\u0027234-567-8901\u0027,\t\u0027Tech Innovations\u0027,\t\u0027CTO\u0027,\t\u0027Contacted\u0027,\t\u0027Design Team\u0027,\t\u00272024-07-02\u0027,\t\u00272024-07-20\u0027,\t\u0027Requested pricing information\u0027,\t70]);\n  sheet.appendRow([\u0027Mark Brown\u0027,\t\u0027mark@example.com\u0027,\t\u0027345-678-9012\u0027,\t\u0027Innovative Inc\u0027,\t\u0027CEO\u0027,\t\u0027Qualified\u0027,\t\u0027Sales Team\u0027,\t\u00272024-07-03\u0027,\t\u00272024-07-18\u0027,\t\u0027Discussed partnership potential\u0027,\t90]);\n}\n\nfunction addTaskExampleData(sheet) {\n  sheet.appendRow([\u0027Task Name\u0027, \u0027Description\u0027, \u0027Progress\u0027, \u0027Assigned by\u0027, \u0027CID\u0027]);\n  sheet.appendRow([\u0027Campaign Setup\u0027, \u0027Set up initial campaign settings\u0027, \u0027In Progress\u0027,\t\u0027John Doe\u0027, \u0027C-1\u0027]);\n  sheet.appendRow([\u0027Design Ad\u0027,\t\u0027Create visuals for the ad campaign\u0027,\t\u0027Not Started\u0027,\t\u0027Jane Smith\u0027,\t\u0027C-1\u0027]);\n  sheet.appendRow([\u0027Contact Leads\u0027,\t\u0027Reach out to new leads for the campaign\u0027,\t\u0027In Progress\u0027,\t\u0027Mark Brown\u0027,\t\u0027C-2\u0027]);\n  sheet.appendRow([\u0027Review Budget\u0027,\t\u0027Review and adjust the campaign budget\u0027,\t\u0027Completed\u0027,\t\u0027John Doe\u0027,\t\u0027C-1\u0027]);\n}\n\nfunction addContentExampleData(sheet) {\n  sheet.appendRow([\u0027Content ID\u0027, \u0027Title\u0027, \u0027Type\u0027, \u0027Category\u0027, \u0027Tags\u0027, \u0027Description\u0027, \u0027Campaign Name\u0027]);\n  sheet.appendRow([\u0027CO-1\u0027, \u0027Summer Sale Ad\u0027, \u0027Image\u0027,\t\u0027Promotion\u0027, \u0027Summer, Sale\u0027, \u0027Ad for Summer Sale\u0027,\t\u0027Sample3\u0027]);\n  sheet.appendRow([\u0027CO-2\u0027,\t\u0027Back to School Blog\u0027,\t\u0027Blog Post\u0027,\t\u0027Education\u0027,\t\u0027Back to School\u0027, \u0027Blog about school season\u0027,\t\u0027Joseph\u0027]);\n}\n\t\t\t\t\t\t\t\t\n// Handles HTTP GET requests\nfunction doGet(e) {\n  return handleDownloadRequest(e);\n}\n\n// Main function to handle download requests\nfunction handleDownloadRequest(e) {\n  var sheetId \u003d \u00271u4hkh71QlWJPI9WWi80e7Ury_EpFu8_uVIyqmCSTnvU\u0027; \n  var exportFormat \u003d \u0027xlsx\u0027; \n\n  var downloadUrl \u003d `https://docs.google.com/spreadsheets/d/${sheetId}/export?format\u003d${exportFormat}`;\n\n  return HtmlService.createHtmlOutput(\n    `\u003chtml\u003e\n       \u003chead\u003e\n         \u003cscript\u003e\n           // Trigger the download\n           window.onload \u003d function() {\n             window.location.href \u003d \"${downloadUrl}\";\n             // Close the tab after a delay to ensure the download has started\n             setTimeout(function() {\n               window.close();\n             }, 1); \n           };\n         \u003c/script\u003e\n       \u003c/head\u003e\n       \u003cbody\u003e\n         \u003cp\u003eYour download will start shortly. If it doesn\u0027t, please \u003ca href\u003d\"${downloadUrl}\" target\u003d\"_blank\"\u003eclick here\u003c/a\u003e.\u003c/p\u003e\n       \u003c/body\u003e\n     \u003c/html\u003e`\n  );\n}\n"}]}